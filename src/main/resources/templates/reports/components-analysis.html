<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</title>
</head>
<body>

<div class="back-btn">
    <a th:href="@{/reports}">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ—Ç—á–µ—Ç–æ–≤</a>
</div>

<h1>ü•ó –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</h1>

<!-- –§–∏–ª—å—Ç—Ä—ã -->
<div class="stats">
    <form th:action="@{/reports/components-analysis}" method="get">
        <label>–¶–µ–Ω–∞ –æ—Ç:</label>
        <input type="number" name="minPrice" step="0.01" th:value="${minPrice}">

        <label>–¶–µ–Ω–∞ –¥–æ:</label>
        <input type="number" name="maxPrice" step="0.01" th:value="${maxPrice}">

        <button type="submit">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
    </form>
</div>

<!-- –ò—Ç–æ–≥–∏ -->
<div class="stats">
    <p>–í—Å–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: <strong th:text="${totalComponents}">0</strong></p>
    <p>–û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±–ª—é–¥–∞—Ö: <strong th:text="${totalUsage}">0</strong></p>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ -->
<table>
    <thead>
    <tr>
        <th>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</th>
        <th>–¶–µ–Ω–∞</th>
        <th>–ö–∞–ª–æ—Ä–∏–∏</th>
        <th>–í–µ—Å</th>
        <th>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–ª—é–¥–∞—Ö</th>
        <th>–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å</th>
        <th>–ë–ª—é–¥–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="comp : ${reportData}">
        <td th:text="${comp.componentName}">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</td>
        <td th:text="${comp.price != null ? #numbers.formatDecimal(comp.price, 1, 2) : '-'}">-</td>
        <td th:text="${comp.calorie != null ? #numbers.formatDecimal(comp.calorie, 1, 2) : '-'}">-</td>
        <td th:text="${comp.weight != null ? #numbers.formatDecimal(comp.weight, 1, 2) : '-'}">-</td>
        <td th:text="${comp.usedInDishes}">0</td>
        <td>
                <span th:if="${comp.usedInDishes > 5}" style="color: green;">
                    –í—ã—Å–æ–∫–∞—è
                </span>
            <span th:if="${comp.usedInDishes > 2 && comp.usedInDishes <= 5}" style="color: orange;">
                    –°—Ä–µ–¥–Ω—è—è
                </span>
            <span th:if="${comp.usedInDishes <= 2}" style="color: #666;">
                    –ù–∏–∑–∫–∞—è
                </span>
        </td>
        <td>
                <span th:each="dish, stat : ${comp.dishNames}">
                    <span th:text="${dish}"></span>
                    <span th:if="${!stat.last}">, </span>
                </span>
            <span th:if="${comp.dishNames.isEmpty()}">–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è</span>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>